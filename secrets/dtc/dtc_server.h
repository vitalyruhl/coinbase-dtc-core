#pragma once\n\n#ifndef DTC_SERVER_SECRETS_H\n#define DTC_SERVER_SECRETS_H\n\n#include <string>\n#include <vector>\n#include <map>\n\nnamespace coinbase_dtc_core {\nnamespace dtc {\nnamespace secrets {\n\n/**\n * DTC Server Authentication & Security Configuration\n * \n * SECURITY WARNING: This file contains sensitive DTC server credentials.\n * - Never commit this file to version control\n * - Use strong passwords in production\n * - Consider IP whitelisting for client connections\n * - Rotate credentials regularly\n * \n * For non-sensitive DTC settings, see include/coinbase_dtc_core/core/settings/core_settings.h\n */\n\n// Server Authentication\nnamespace authentication {\n    // Enable/disable authentication (false = allow anonymous connections)\n    const bool ENABLE_AUTHENTICATION = true;\n    \n    // Test credentials (change for production!)\n    const std::string DEFAULT_USERNAME = \"testDTCUser\";\n    const std::string DEFAULT_PASSWORD = \"testDTCPassword\";\n    \n    // Additional user accounts (username -> password)\n    const std::map<std::string, std::string> USER_ACCOUNTS = {\n        {\"testDTCUser\", \"testDTCPassword\"},\n        {\"demo_user\", \"demo123\"},\n        {\"admin\", \"admin_password_change_me\"}  // TODO: Change in production!\n    };\n    \n    // Session settings\n    const int SESSION_TIMEOUT_MINUTES = 30;\n    const int MAX_LOGIN_ATTEMPTS = 3;\n    const int LOCKOUT_DURATION_MINUTES = 15;\n}\n\n// SSL/TLS Configuration\nnamespace ssl {\n    // Enable SSL/TLS encryption\n    const bool ENABLE_SSL = false;  // Set to true for production\n    \n    // Certificate paths (relative to project root)\n    const std::string CERT_FILE_PATH = \"secrets/dtc/server.crt\";\n    const std::string PRIVATE_KEY_PATH = \"secrets/dtc/server.key\";\n    const std::string CA_FILE_PATH = \"secrets/dtc/ca.crt\";\n    \n    // SSL settings\n    const std::string SSL_CIPHER_SUITE = \"ECDHE+AESGCM:ECDHE+CHACHA20:DHE+AESGCM:DHE+CHACHA20:!aNULL:!MD5:!DSS\";\n    const int SSL_VERIFY_MODE = 1;  // 0=none, 1=optional, 2=required\n}\n\n// Network Security\nnamespace network {\n    // Allowed client IP addresses (empty = allow all)\n    const std::vector<std::string> ALLOWED_IPS = {\n        // \"127.0.0.1\",     // localhost\n        // \"10.0.0.0/8\",    // Private network\n        // \"192.168.0.0/16\" // Private network\n    };\n    \n    // Rate limiting\n    const int MAX_CONNECTIONS_PER_IP = 5;\n    const int MAX_REQUESTS_PER_SECOND = 100;\n    const int MAX_MESSAGE_SIZE_BYTES = 65536;  // 64KB\n}\n\n// Database Credentials (for user management, if needed)\nnamespace database {\n    const std::string DB_HOST = \"localhost\";\n    const std::string DB_PORT = \"5432\";\n    const std::string DB_NAME = \"dtc_server\";\n    const std::string DB_USERNAME = \"dtc_user\";\n    const std::string DB_PASSWORD = \"dtc_password_change_me\";\n    \n    // Connection pool\n    const int MAX_CONNECTIONS = 10;\n    const int CONNECTION_TIMEOUT_SECONDS = 30;\n}\n\n// Monitoring & Logging\nnamespace monitoring {\n    // External monitoring service credentials\n    const std::string METRICS_API_KEY = \"\";\n    const std::string ALERTING_WEBHOOK_URL = \"\";\n    \n    // Log encryption key (for sensitive log data)\n    const std::string LOG_ENCRYPTION_KEY = \"change_me_32_char_key_for_logs\";\n    \n    // Remote logging service\n    const std::string REMOTE_LOG_ENDPOINT = \"\";\n    const std::string REMOTE_LOG_API_KEY = \"\";\n}\n\n// Docker Environment Variable Overrides\n// These settings can be overridden via Docker environment variables:\n// \n// docker run -e DTC_USERNAME=myuser -e DTC_PASSWORD=mypass ...\n// \nnamespace docker_env {\n    // Environment variable names for Docker deployment\n    const std::string ENV_USERNAME = \"DTC_USERNAME\";           // Override DEFAULT_USERNAME\n    const std::string ENV_PASSWORD = \"DTC_PASSWORD\";           // Override DEFAULT_PASSWORD\n    const std::string ENV_ENABLE_AUTH = \"DTC_ENABLE_AUTH\";     // Override ENABLE_AUTHENTICATION\n    const std::string ENV_ENABLE_SSL = \"DTC_ENABLE_SSL\";       // Override ENABLE_SSL\n    const std::string ENV_PORT = \"DTC_PORT\";                   // Override default port\n    const std::string ENV_ALLOWED_IPS = \"DTC_ALLOWED_IPS\";     // Comma-separated IPs\n    const std::string ENV_DB_HOST = \"DTC_DB_HOST\";             // Override DB_HOST\n    const std::string ENV_DB_PASSWORD = \"DTC_DB_PASSWORD\";     // Override DB_PASSWORD\n    const std::string ENV_LOG_LEVEL = \"DTC_LOG_LEVEL\";         // Override log level\n    \n    // Helper function to get environment variable with fallback\n    inline std::string get_env_or_default(const std::string& env_name, const std::string& default_value) {\n        const char* env_value = std::getenv(env_name.c_str());\n        return env_value ? std::string(env_value) : default_value;\n    }\n    \n    // Helper function to get boolean environment variable\n    inline bool get_env_bool_or_default(const std::string& env_name, bool default_value) {\n        const char* env_value = std::getenv(env_name.c_str());\n        if (!env_value) return default_value;\n        std::string value = std::string(env_value);\n        std::transform(value.begin(), value.end(), value.begin(), ::tolower);\n        return value == \"true\" || value == \"1\" || value == \"yes\";\n    }\n}\n\n// Production Deployment Notes\n/*\nFÜR VPS/PRODUCTION DEPLOYMENT:\n\n1. AUTHENTIFIZIERUNG:\n   - Ändern Sie alle Default-Passwörter!\n   - Verwenden Sie starke, einzigartige Passwörter\n   - Aktivieren Sie SSL/TLS (ENABLE_SSL = true)\n\n2. DOCKER DEPLOYMENT:\n   docker run -d \\\n     -e DTC_USERNAME=ihr_sicherer_username \\\n     -e DTC_PASSWORD=ihr_sicheres_passwort \\\n     -e DTC_ENABLE_SSL=true \\\n     -e DTC_ALLOWED_IPS=\"192.168.1.0/24,10.0.0.0/8\" \\\n     -p 11099:11099 \\\n     coinbase-dtc-server\n\n3. SIERRA CHART VERBINDUNG:\n   - Host: Ihre VPS IP-Adresse\n   - Port: 11099 (oder Ihr gewählter Port)\n   - Username: Ihr DTC_USERNAME\n   - Password: Ihr DTC_PASSWORD\n   - SSL: Aktivieren wenn ENABLE_SSL=true\n\n4. FIREWALL:\n   - Öffnen Sie nur Port 11099 (oder Ihren gewählten Port)\n   - Beschränken Sie Zugriff auf bekannte IP-Bereiche\n   - Verwenden Sie fail2ban für zusätzlichen Schutz\n\n5. MONITORING:\n   - Überwachen Sie Verbindungen und failed logins\n   - Setzen Sie Alerts für ungewöhnliche Aktivitäten\n   - Loggen Sie alle Authentifizierungsversuche\n*/\n\n} // namespace secrets\n} // namespace dtc\n} // namespace coinbase_dtc_core\n\n#endif // DTC_SERVER_SECRETS_H"